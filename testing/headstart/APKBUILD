# Maintainer: Dan Williams <dan@ma.ssive.co>
pkgname=headstart
pkgver=0.1.3
pkgrel=0
pkgdesc="Simple early initialization of instances."
url="https://github.com/massiveco/headstart"
giturl="git@github.com:massiveco/headstart.git"
arch="all"
license="Apache-2.0"
makedepends="go bash"
source="$pkgname-$pkgver.tar.gz::${url}/archive/v${pkgver}.tar.gz"
builddir="$srcdir/src/github.com/massiveco/headstart"

export GOPATH="$srcdir"

prepare() {
	mkdir -p ${builddir%/*}
	mv "$srcdir"/$pkgname-${pkgver} "$builddir"/
	default_prepare
}

build() {
	cd "$builddir"
	go get ./...
	make all
}

check() {
	cd "$builddir"
	go test ./...
}

package() {
	install -Dm755 "$builddir"/headstart "$pkgdir"/usr/bin/headstart
	install -Dm755 "$builddir"/providers/aws.so "$pkgdir"/usr/lib/headstart/providers/aws.so
	install -Dm755 "$builddir"/providers/local.so "$pkgdir"/usr/lib/headstart/providers/local.so
}

sha512sums="5df3d42395fda48d969b1a7310828ea9a8e761f55af1d7c4e5a140e439a80a52770e94d49084f0aca426512440bb7cc11c74fdd29ca11ad1ab3922df6530f8f9  headstart-0.1.3.tar.gz"
